<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>DNS Lookup Tool</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      margin: 40px;
      background: #f8fafc;
      color: #222;
    }
    h2 {
      color: #0078d7;
      margin-bottom: 15px;
    }
    input, select {
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 14px;
    }
    input {
      width: 250px;
    }
    button {
      padding: 10px 20px;
      border: none;
      background: #0078d7;
      color: white;
      font-size: 14px;
      border-radius: 5px;
      cursor: pointer;
      margin-left: 5px;
    }
    button:hover {
      background: #005fa3;
    }
    #result {
      margin-top: 30px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      background: white;
      margin-top: 15px;
    }
    th, td {
      padding: 10px;
      border: 1px solid #ddd;
      text-align: left;
      font-size: 14px;
    }
    th {
      background-color: #f2f2f2;
      font-weight: bold;
    }
    .error {
      color: red;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h2>:mag: DNS Lookup Tool</h2>
  <input id="domain" placeholder="example.com" />
  <select id="recordType">
    <option value="A">A</option>
    <option value="AAAA">AAAA</option>
    <option value="CNAME">CNAME</option>
    <option value="MX">MX</option>
    <option value="TXT">TXT</option>
    <option value="SPF">SPF</option>
    <option value="DMARC">DMARC</option>
  </select>
  <button onclick="lookup()">Lookup</button>
  <div id="result"></div>
  <script>
    async function lookupDNS(domain, type) {
      let query = domain;
      // Adjust query for special cases
      if (type === "DMARC") query = `_dmarc.${domain}`;
      if (type === "SPF") type = "TXT"; // SPF is within TXT records
      const api = `https://cloudflare-dns.com/dns-query?name=${query}&type=${type}`;
      const res = await fetch(api, { headers: { 'Accept': 'application/dns-json' } });
      if (!res.ok) throw new Error("Failed to fetch DNS data");
      const data = await res.json();
      return data.Answer || [];
    }
    function renderTable(title, records) {
      if (!records.length) return `<p><b>${title}:</b> No records found.</p>`;
      let rows = records.map(r => `
        <tr>
          <td>${r.name}</td>
          <td>${r.type}</td>
          <td>${r.data}</td>
        </tr>
      `).join('');
      return `
        <h3>${title}</h3>
        <table>
          <tr><th>Name</th><th>Type</th><th>Value</th></tr>
          ${rows}
        </table>
      `;
    }
    async function lookup() {
      const domain = document.getElementById('domain').value.trim();
      const type = document.getElementById('recordType').value;
      const resultDiv = document.getElementById('result');
      if (!domain) return alert('Please enter a domain.');
      resultDiv.innerHTML = '<p>:hourglass_flowing_sand: Looking up...</p>';
      try {
        const records = await lookupDNS(domain, type);
        // If SPF selected, filter for SPF-specific TXT records
        let filtered = records;
        if (type === "SPF") {
          filtered = records.filter(r => r.data.includes("v=spf1"));
        }
        resultDiv.innerHTML = renderTable(`:small_blue_diamond: ${type} Record(s)`, filtered);
      } catch (err) {
        resultDiv.innerHTML = `<p class="error">:x: Lookup failed: ${err.message}</p>`;
      }
    }
  </script>
</body>
</html>
